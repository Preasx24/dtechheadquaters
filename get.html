<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Host Connection Assistant</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f4;
        }
        .container {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: auto;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label, select, input, button {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .response {
            margin-top: 20px;
            padding: 15px;
            background-color: #e7f5e7;
            border-radius: 5px;
            border: 1px solid #4CAF50;
            color: #2e7d32;
        }
        .payload {
            background-color: #f2f2f2;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-family: monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .dropdown-container {
            display: none;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Host Connection Assistant</h1>
        <form id="hostForm">
            <label for="statusCode">Enter the status code of the host:</label>
            <input type="number" id="statusCode" name="statusCode" min="100" max="599" required>

            <label for="hostName">Enter the host URL:</label>
            <input type="text" id="hostName" name="hostName" required>

            <button type="submit">Get Suggestions & Generate Payload</button>
        </form>

        <div id="response" class="response" style="display:none;"></div>
        <div id="payloadSection" class="payload" style="display:none;"></div>

        <button id="showHeaderInput" type="button">Generate Header Payload</button>
        <div id="headerDropdown" class="dropdown-container">
            <label for="header">Select or Input Header:</label>
            <input type="text" id="header" name="header" placeholder="Enter or select header...">
            <button type="button" id="generateHeaderPayload">Generate Payload</button>
            <div id="headerPayload" class="payload" style="display:none;"></div>
        </div>
    </div>

    <script>
        // Function to fetch payloads from the 302.json file
        async function fetchPayloads() {
            try {
                const response = await fetch('302.json');
                return await response.json();
            } catch (error) {
                console.error("Error fetching payloads:", error);
            }
        }

        // Event listener for form submission
        document.getElementById('hostForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const statusCode = document.getElementById('statusCode').value;
            const hostName = document.getElementById('hostName').value;

            // Fetch payload data
            const payloadData = await fetchPayloads();
            let responseMessage = '';
            let payloadMessage = '';

            // Check if payloads exist for the entered status code
            if (payloadData[statusCode]) {
                responseMessage = `Status Code ${statusCode}: Payload suggestions are available for this status code.`;
                payloadMessage = generatePayload(payloadData, statusCode, hostName);
            } else {
                responseMessage = `Status Code ${statusCode}: Unable to provide a specific recommendation for this status code.`;
                payloadMessage = 'Try using V2Ray or SSH with WebSocket or Tunnel for better results.';
            }

            document.getElementById('response').innerText = responseMessage;
            document.getElementById('response').style.display = 'block';
            document.getElementById('payloadSection').innerText = payloadMessage;
            document.getElementById('payloadSection').style.display = 'block';
        });

        // Function to generate payload for headers based on status code
        function generatePayload(payloadData, statusCode, hostName) {
            const headers = payloadData[statusCode];
            let payloadMessage = '';

            if (headers) {
                for (const header in headers) {
                    payloadMessage += `Payload for header ${header}:\n${headers[header]}\n\n`;
                }
            } else {
                payloadMessage = 'No specific payloads found for this status code.';
            }

            return payloadMessage;
        }

        // Event listener for generating payload based on header and status code
        document.getElementById('generateHeaderPayload').addEventListener('click', async function() {
            const header = document.getElementById('header').value;
            const statusCode = document.getElementById('statusCode').value;

            const payloadData = await fetchPayloads();
            let headerPayloadMessage = '';

            if (header && statusCode && payloadData[statusCode] && payloadData[statusCode][header]) {
                headerPayloadMessage = payloadData[statusCode][header];
            } else {
                headerPayloadMessage = "No payload found for this header and status code.";
            }

            document.getElementById('headerPayload').innerText = headerPayloadMessage;
            document.getElementById('headerPayload').style.display = 'block';
        });

        // Show the header input section
        document.getElementById('showHeaderInput').addEventListener('click', function() {
            document.getElementById('headerDropdown').style.display = 'block';
        });
    </script>

</body>
</html>